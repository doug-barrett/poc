fileVersion: 1
id: 55805c40-056a-41a6-bbc4-cbf672f83964
name: GD_HEADCOUNT
operation:
  config:
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: Final headcount summary with active, transfer, and total employees by organizational unit
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd5fbf17-5120-483b-8360-dc8dbf145a68
          stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
        config: {}
        dataType: NUMBER
        description: Unique identifier for a specific physical location. Part of the composite key with ORGANIZATIONAL_UNIT_ID and APPLY_DATE. Sourced directly from the ATP table. Used in facilities management reports to track resource allocation and employee distribution across different sites. Enables spatial analysis of workforce demographics. Referenced in reports detailing location-specific operational metrics. No transformations applied.
        isBusinessKey: true
        name: LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd5fbf17-5120-483b-8360-dc8dbf145a68
                stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
            transform: ATP."LOCATION_ID"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f61a71c4-1717-415c-b493-5d075e3f2ec8
          stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
        config: {}
        dataType: VARCHAR
        description: Identifier for the organizational unit within the company. Part of the composite key with LOCATION_ID and APPLY_DATE. Originates from the ATP table. Used in organizational charts and departmental performance dashboards. Facilitates analysis of employee distribution and resource allocation across different business units. No transformations applied. Essential for hierarchical reporting and management oversight.
        isBusinessKey: true
        name: ORGANIZATIONAL_UNIT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f61a71c4-1717-415c-b493-5d075e3f2ec8
                stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
            transform: ATP."ORGANIZATIONAL_UNIT_ID"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8a5868-7d2e-420b-bc2b-6073952c3771
          stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
        config: {}
        dataType: VARCHAR
        description: Date when the employee data was applied or became effective. Part of the composite key with LOCATION_ID and ORGANIZATIONAL_UNIT_ID. Extracted directly from the ATP table. Used to track changes in employee counts and organizational structure over time. Enables trend analysis and historical reporting on workforce dynamics. No transformations applied. Critical for auditing and compliance purposes.
        isBusinessKey: true
        name: APPLY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8a5868-7d2e-420b-bc2b-6073952c3771
                stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
            transform: ATP."APPLY_DATE"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e52f2c23-d8db-4125-88bc-963d4bbcb6fe
          stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
        config: {}
        dataType: NUMBER
        description: Number of employees transferred into or out of a location. Sourced as TRANSFER_PERSONS from the ATP table. Used in mobility reports to analyze internal employee movement. Helps identify trends in employee relocation and its impact on different locations. Supports workforce planning and resource management by tracking employee transfers. No transformations applied.
        name: TRANSFER_EMPLOYEES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e52f2c23-d8db-4125-88bc-963d4bbcb6fe
                stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
            transform: ATP."TRANSFER_PERSONS"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53482185-e697-4895-9b3d-e098acb6a461
          stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
        config: {}
        dataType: NUMBER
        description: Count of employees currently active at a specific location. Derived from ACTIVE_PERSONS in the ATP table. Used in headcount reports and workforce utilization dashboards. Provides a snapshot of the current staffing levels at each location. Supports resource allocation and capacity planning. No transformations applied. Essential for operational monitoring and performance management.
        name: ACTIVE_EMPLOYEES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53482185-e697-4895-9b3d-e098acb6a461
                stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
            transform: ATP."ACTIVE_PERSONS"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36ecc1e5-bff0-43e6-92f6-b1e993afd718
          stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
        config: {}
        dataType: NUMBER
        description: Total number of employees at a location. Defaults to zero if the source value is null. Calculated using COALESCE on TOTAL_PERSONS from the TP table. Used in overall workforce size analysis and location-based reporting. Provides a comprehensive view of the total workforce at each location. Supports strategic planning and resource allocation decisions.
        name: TOTAL_EMPLOYEES1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47b97355-8771-46e0-a503-8360593c0430
                stepCounter: 55805c40-056a-41a6-bbc4-cbf672f83964
            transform: COALESCE(TP."TOTAL_PERSONS", 0)
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          ATP: fc624fba-8f66-424f-b74d-8bde03ab0677
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SILVER
            nodeName: STG_ACTIVE_AND_TRANSFER_PERSONS
          - locationName: SILVER
            nodeName: STG_TOTAL_PERSONS
        join:
          joinCondition: |-
            FROM {{ ref('SILVER', 'STG_ACTIVE_AND_TRANSFER_PERSONS') }} ATP
            LEFT JOIN {{ ref('SILVER', 'STG_TOTAL_PERSONS') }} TP 
              ON TP."APPLY_DATE" = ATP."APPLY_DATE"
             AND TP."ORGANIZATIONAL_UNIT_ID" = ATP."ORGANIZATIONAL_UNIT_ID"
        name: GD_HEADCOUNT
        noLinkRefs: []
  name: GD_HEADCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Dimension
  type: sql
  version: 1
type: Node
